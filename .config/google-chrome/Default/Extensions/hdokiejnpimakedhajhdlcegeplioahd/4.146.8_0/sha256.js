var lp_sha2lib=SHA256lib();function SHA256(t,e){return lp_sha2lib.sha256(t,e)}function SHA256_crypt(t){var e=rand_str(16);return lp_sha2lib.crypt_sha256(t,e,5e3,null)}function ab2bin(t){for(var e=1024,n=new Uint8Array(t),o="",r=0;r<Math.ceil(t.byteLength/e);r++)o+=String.fromCharCode.apply(null,n.slice(r*e,e*(r+1)));return o}function bin2ab(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o<t.length;++o)n[o]=t.charCodeAt(o);return e}function lp_pbkdf2_sync(t,e,n,o,r){if("undefined"!=typeof document&&document.getElementById("lpplugin")&&"function"==typeof document.getElementById("lpplugin").pbkdf2){var a=document.getElementById("lpplugin").pbkdf2(btoa(t),btoa(e),n,o);return"function"==typeof r&&r(AES.hex2bin(a),t,n),a}if("undefined"!=typeof g_oldpbkdf2&&1==g_oldpbkdf2||"function"!=typeof lpusexpcomencrypt||!lpusexpcomencrypt()||"function"!=typeof lpxpcomobj.pbkdf2){if("undefined"!=typeof g_oldpbkdf2&&1==g_oldpbkdf2||"function"!=typeof lpuseopensslpbkdf2||!lpuseopensslpbkdf2()||"function"!=typeof lpopensslpbkdf2){if("undefined"!=typeof g_oldpbkdf2&&1==g_oldpbkdf2||"function"!=typeof have_binary_function||!have_binary_function("pbkdf2")||"function"!=typeof r){if("undefined"!=typeof g_oldpbkdf2&&1==g_oldpbkdf2||"function"!=typeof have_nplastpass||!have_nplastpass()||"undefined"==typeof g_nplastpass||"function"!=typeof g_nplastpass.pbkdf2)return"undefined"!=typeof g_oldpbkdf2&&1==g_oldpbkdf2||"function"!=typeof have_pplastpass||!have_pplastpass()||"function"!=typeof r?"undefined"!=typeof lptoolband&&"undefined"!=typeof lptoolbandcall?"string"!=typeof(a=lptoolbandcall(["lppbkdf2",btoa(t),btoa(e),parseInt(n),o]))||0==a.length?lp_sha2lib.pbkdf2(t,e,n,o,r):("function"==typeof r&&r(AES.hex2bin(a),t,n),a):lp_sha2lib.pbkdf2(t,e,n,o,r):pplastpass_send_message({cmd:"pbkdf2",password:btoa(t),salt:btoa(e),num_iterations:parseInt(n),num_bytes:o},(function(e){r(AES.hex2bin(e),t,n)}));a=g_nplastpass.pbkdf2(btoa(t),btoa(e),n,o);return"function"==typeof r&&r(AES.hex2bin(a),t,n),a}return call_binary_function("pbkdf2",btoa(t),btoa(e),parseInt(n),o,(function(e){r(AES.hex2bin(e),t,n)}))}var a=lpopensslpbkdf2(t,e,n,o);return"function"==typeof r&&r(AES.hex2bin(a),t,n),a}var a=lpxpcomobj.pbkdf2(btoa(t),btoa(e),n,o);return"function"==typeof r&&r(AES.hex2bin(a),t,n),a}function lp_pbkdf2(t,e,n,o,r){if(!(r&&"undefined"!==typeof crypto&&crypto.subtle&&crypto.subtle.importKey&&crypto.subtle.deriveKey&&crypto.subtle.exportKey))return lp_pbkdf2_sync(t,e,n,o,r);crypto.subtle.importKey("raw",bin2ab(t),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]).then((function(t){return crypto.subtle.deriveKey({name:"PBKDF2",salt:bin2ab(e),iterations:parseInt(n,10),hash:"SHA-256"},t,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])})).then((function(t){return crypto.subtle.exportKey("raw",t)})).then((function(e){r(ab2bin(e),t,n)})).catch((function(){lp_pbkdf2_sync(t,e,n,o,r)}))}function SHA256lib(){function t(t){null==t&&(t=""),t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e+=String.fromCharCode(o):o>127&&o<2048?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e}function e(t,e,n,o){var r=t<<16|e<<8|n;out="";for(var a=0;a<o;a++)out+="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(63&r),r>>>=6;return out}return{sha256:function(e,n){e=t(e);for(var o=[],r=0;r<e.length;r++)o[r]=e.charCodeAt(r);e=sjcl.codec.bytes.toBits(o);var a=sjcl.hash.sha256.hash(e,8*e.length);if("undefined"!=typeof n&&1==n){var s=sjcl.codec.bytes.fromBits(a),p=[];for(r=0;r<s.length/4;r++)p[r]=s[4*r]<<24|s[4*r+1]<<16|s[4*r+2]<<8|s[4*r+3];return p}return sjcl.codec.hex.fromBits(a)},sha512:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t.charCodeAt(n);t=sjcl.codec.bytes.toBits(e);var o=sjcl.hash.sha512.hash(t,8*t.length);return sjcl.codec.hex.fromBits(o)},crypt_sha256:function(t,n,o,r){var a=[],s=[];n.length>16&&(n=n.substr(0,16)),o<1e3&&(o=1e3);for(var p=0;p<t.length;p++)a[p]=t.charCodeAt(p);for(p=0;p<n.length;p++)s[p]=n.charCodeAt(p);password_bits=sjcl.codec.bytes.toBits(a),salt_bits=sjcl.codec.bytes.toBits(s);var f=new sjcl.hash.sha256;f.update(password_bits),f.update(salt_bits);var i=new sjcl.hash.sha256;i.update(password_bits),i.update(salt_bits),i.update(password_bits);var l,c=i.finalize();for(l=t.length;l>32;l-=32)f.update(c);for(f.update(sjcl.bitArray.bitSlice(c,0,8*l)),l=t.length;l>0;l>>=1)0!==(1&l)?f.update(c):f.update(password_bits);var d=f.finalize(),u=new sjcl.hash.sha256;for(l=0;l<t.length;l++)u.update(password_bits);var b=u.finalize(),h=[];for(l=t.length;l>=32;l-=32)h=sjcl.bitArray.concat(h,b);h=sjcl.bitArray.concat(h,sjcl.bitArray.bitSlice(b,0,8*l));var y=new sjcl.hash.sha256;for(l=0;l<16+sjcl.bitArray.extract(d,0,8);l++)y.update(salt_bits);var _=y.finalize(),g=[];for(l=n.length;l>=32;l-=32)g=sjcl.bitArray.concat(g,_);for(g=sjcl.bitArray.concat(g,sjcl.bitArray.bitSlice(_,0,8*l)),l=0;l<o;l++){var v=new sjcl.hash.sha256;1===(1&l)?v.update(h):v.update(d),l%3!==0&&v.update(g),l%7!==0&&v.update(h),1===(1&l)?v.update(d):v.update(h),d=v.finalize()}var m="$5$";5e3!=o&&(m+="rounds="+o+"$"),m+=n+"$";var A=sjcl.codec.bytes.fromBits(d);if(m+=e(A[0],A[10],A[20],4),m+=e(A[21],A[1],A[11],4),m+=e(A[12],A[22],A[2],4),m+=e(A[3],A[13],A[23],4),m+=e(A[24],A[4],A[14],4),m+=e(A[15],A[25],A[5],4),m+=e(A[6],A[16],A[26],4),m+=e(A[27],A[7],A[17],4),m+=e(A[18],A[28],A[8],4),m+=e(A[9],A[19],A[29],4),m+=e(0,A[31],A[30],3),"function"!==typeof r)return m;r(m)},pbkdf2:function(t,e,n,o,r){for(var a=[],s=[],p=0;p<t.length;p++)a[p]=t.charCodeAt(p);for(p=0;p<e.length;p++)s[p]=e.charCodeAt(p);t=sjcl.codec.bytes.toBits(a),e=sjcl.codec.bytes.toBits(s);var f=sjcl.misc.pbkdf2(t,e,n,8*o,null,r,null);if("function"!==typeof r)return sjcl.codec.hex.fromBits(f)},utf8encode:function(e){return t(e)}}}