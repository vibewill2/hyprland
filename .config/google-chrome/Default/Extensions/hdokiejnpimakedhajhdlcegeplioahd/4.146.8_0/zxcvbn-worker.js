var WORKER_MESSAGE_COMPUTE_PW_SCORE="compute_password_strength",WORKER_MESSAGE_COMPUTE_PW_SCORE_RESULT="compute_password_strength_result";if("function"===typeof importScripts){var startTime,isSPA=location.pathname.startsWith("/vault/");if("https:"!=location.protocol||isSPA){var baseUrl=location.pathname.slice(0,-26);isSPA&&(baseUrl="/vault"),importScripts(baseUrl+"/zxcvbn.js"),importScripts(baseUrl+"/zxcvbn-ts.js"),importScripts(baseUrl+"/zxcvbn-ts-language-common.js"),importScripts(baseUrl+"/zxcvbn-ts-language-en.js"),importScripts(baseUrl+"/zxcvbn-ts-language-de.js"),importScripts(baseUrl+"/zxcvbn-ts-language-es-es.js"),importScripts(baseUrl+"/zxcvbn-ts-language-fr.js"),importScripts(baseUrl+"/zxcvbn-ts-language-it.js"),importScripts(baseUrl+"/zxcvbn-ts-language-nl-be.js"),importScripts(baseUrl+"/zxcvbn-ts-language-pt-br.js"),importScripts(baseUrl+"/sjcl.js"),importScripts(baseUrl+"/sha256.js")}else importScripts("/js-thirdparty/zxcvbn.js"),importScripts("/js-thirdparty/zxcvbn-ts-core.min.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-common.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-en.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-de.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-es-es.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-fr.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-it.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-nl-be.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-pt-br.js"),importScripts("/js/sjcl/sjcl.js"),importScripts("/js/sha256.js");var LEVENSHTEIN_DEFAULT=!1,useLevenshteinDistance=LEVENSHTEIN_DEFAULT;function addToDictionary(x,e){Object.keys(e).forEach((function(n){x[n]?x[n].concat(e[n]):x[n]=e[n]}))}function setupZXCVBN(x){var e={};addToDictionary(e,zxcvbnts["language-common"].dictionary),addToDictionary(e,zxcvbnts["language-en"].dictionary),addToDictionary(e,zxcvbnts["language-de"].dictionary),addToDictionary(e,zxcvbnts["language-es-es"].dictionary),addToDictionary(e,zxcvbnts["language-fr"].dictionary),addToDictionary(e,zxcvbnts["language-it"].dictionary),addToDictionary(e,zxcvbnts["language-nl-be"].dictionary),addToDictionary(e,zxcvbnts["language-pt-br"].dictionary);var n={useLevenshteinDistance:x,translations:zxcvbnts["language-en"].translations,graphs:zxcvbnts["language-common"].adjacencyGraphs,dictionary:e};zxcvbnts.core.zxcvbnOptions.setOptions(n),useLevenshteinDistance=x}function handleSecurityScoreCalculation(x){startTime=(new Date).getTime(),setupZXCVBN(LEVENSHTEIN_DEFAULT),challengecomputescore_async(x.data.curr,x.data.g_totalscore,JSON.parse(x.data.g_sites),x.data.g_aSites&&x.data.g_aSites.length?x.data.g_aSites:[],x.data.g_numsites,x.data.g_numblanksites,x.data.g_avgpasswordlength,x.data.g_aPasswords,x.data.g_MAXNUMCOMPUTESCORE,x.data.g_numduppasswords,x.data.g_numdupsites,x.data.g_usernames,x.data.WEAKPASSWORDSCORE,x.data.g_strengthscore,x.data.g_countscore,x.data.g_numweak,x.data.sharedavgstrength,x.data.SharedAccounts,x.data.g_runtimems,x.data.sfcounts,x.data.sharedstrengthscore,x.data.sharedblanksites,x.data.sharedweak,x.data.sharedavgpasswordlength,x.data.SharedPasswords,x.data.sharedcountscore,x.data.NonSharedAccounts,x.data.g_SFNames,x.data.AllSFNames,x.data.sharedtotalscore,x.data.g_numvulnerablesites,x.data.g_allPasswords,x.data.g_reuse,x.data.g_blanksites,x.data.g_allnumduppasswords,x.data.equivalentDomainCheckList,x.data.isExcludeSwitchedOn,x.data.excludedPasswords,x.data.domainsForAutomaticPasswordExclude,x.data.isFeatureEnabledSecurityDashboard2_0,x.data.dwmAlerts,x.data.SFNameToID,x.data.AIDtoSFNames,x.data.AllSFIDs,x.data.g_myaccounts,x.data.g_avgstrength)}function challengegetstrength(x,e){return 25*calculatePasswordStrength(e,x)}function calculatePasswordStrength(x,e){if("undefined"===typeof zxcvbnts)throw new Error("No zxcvbn functionality available");var n=x?x.substring(0,50).replace(/\s/g,""):"",t=e?e.substring(0,50).toLowerCase():"";return zxcvbnts.core.zxcvbn(n,[t,"lastpass","lastpass.com"]).score}function challengecomputescore_async(x,e,n,t,a,s,d,r,o,i,c,u,f,l,p,g,h,y,m,_,v,S,b,E,w,j,O,T,D,P,z,U,N,A,L,M,C,R,k,F,W,I,V,H,X,K){function B(){var x={cmd:"report",runtimesec:"undefined"!==typeof mx?mx:void 0,calcTimeMs:"undefined"!==typeof startTime?(new Date).getTime()-startTime:void 0,g_totalscore:"undefined"!==typeof e?e:void 0,g_aSites:"undefined"!==typeof t?t:void 0,g_numsites:"undefined"!==typeof a?a:0,g_numblanksites:"undefined"!==typeof s?s:0,g_avgpasswordlength:"undefined"!==typeof d?d:0,g_avgstrength:"undefined"!==typeof K?K:0,g_aPasswords:"undefined"!==typeof r?r:{},g_MAXNUMCOMPUTESCORE:"undefined"!==typeof o?o:0,g_numduppasswords:"undefined"!==typeof i?i:0,g_numdupsites:"undefined"!==typeof c?c:0,g_usernames:"undefined"!==typeof u?u:[],WEAKPASSWORDSCORE:"undefined"!==typeof f?f:50,g_strengthscore:"undefined"!==typeof l?l:0,g_countscore:"undefined"!==typeof p?p:0,g_numweak:"undefined"!==typeof g?g:0,sharedavgstrength:"undefined"!==typeof h?h:[],SharedAccounts:"undefined"!==typeof y?y:[],g_runtimems:"undefined"!==typeof m?m:0,sfcounts:"undefined"!==typeof _?_:[],sharedstrengthscore:"undefined"!==typeof v?v:[],sharedblanksites:"undefined"!==typeof S?S:[],sharedweak:"undefined"!==typeof b?b:[],sharedavgpasswordlength:"undefined"!==typeof E?E:[],SharedPasswords:"undefined"!==typeof w?w:[],sharedcountscore:"undefined"!==typeof j?j:[],NonSharedAccounts:"undefined"!==typeof O?O:[],g_SFNames:"undefined"!==typeof T?T:[],AllSFNames:"undefined"!==typeof D?D:[],sharedtotalscore:"undefined"!==typeof P?P:[],g_numvulnerablesites:"undefined"!==typeof z?z:0,g_allPasswords:"undefined"!==typeof U?U:{},g_reuse:"undefined"!==typeof N?N:void 0,g_blanksites:"undefined"!==typeof A?A:void 0,g_allnumduppasswords:"undefined"!==typeof L?L:0};x.report=function(x){var e,n={totalscore:x.g_totalscore,numblanksites:x.g_numblanksites,numvulnerablesites:x.g_numvulnerablesites,numduppasswords:x.g_numduppasswords,numallduppasswords:x.g_allnumduppasswords,numdupsites:x.g_numdupsites,numalldupsites:0,numweak:x.g_numweak,avgstrength:x.g_avgstrength,countscore:x.g_countscore},a=0;for(e in U)if(U.hasOwnProperty(e)){var s="";for(var d in U[e])if(U[e].hasOwnProperty(d)){var r=U[e][d];for(var o in r)if(r.hasOwnProperty(o)){var i=I[V[t[r[o]].id]];"undefined"==typeof i&&(i="NotShared"),s+=i+":"+t[r[o]].id+","}}n["dupsites_global_"+a]=s,a++}e="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";for(var c="",u=0;u<t.length;u++)"undefined"!=typeof t[u].challenge_scorefinal&&("undefined"==typeof t[u].sfname||"nonshared"==t[u].sfname)&&parseInt(t[u].challenge_scorefinal)<f&&(c+=t[u].id+":"+t[u].challenge_scorefinal.toFixed(2)+",");n.weak=c;var l=[],p=[];for(u=0;u<D.length;u++){var g=D[u],m=I[g];p[u]=m,n[m+"_sfname"]=g,n[m+"_totalscore"]=P[g],n[m+"_numaccts"]=y[g]?y[g].length:0,n[m+"_numblanksites"]=S[g],n[m+"_numweak"]=b[g],n[m+"_avgstrength"]=h[g],n[m+"_countscore"]=j[g]}return n.SFIDs=p,n.AllSFIDs=H,n.SFScores=l,n.SharedFolderList=D,n.my_accts=X.length,n}(x),postMessage(x)}if(0===e){var G,Z,J,q,Q,Y,$=0;for(M="undefined"===typeof M?{}:M,"undefined"!=typeof t[yx="undefined"==typeof x?0:x]&&"undefined"!=typeof t[yx].sfname&&(xx=t[yx].sfname),"undefined"==typeof xx&&(xx="nonshared"),"undefined"==typeof _&&(_=[]),"undefined"==typeof v&&(v=[]),"undefined"==typeof S&&(S=[]),"undefined"==typeof b&&(b=[]),"undefined"==typeof E&&(E=[]),"undefined"==typeof w&&(w=[]),"undefined"==typeof j&&(j=[]),"undefined"==typeof O&&(O=[]),"undefined"==typeof T&&(T=[]),"undefined"==typeof D&&(D=[]),"undefined"==typeof _[xx]&&(_[xx]=0),_[xx]++,"undefined"==typeof x&&(g_challengeregexcache=[]);yx<a;++yx){if("function"==typeof reportprogress&&reportprogress(yx,a),xx="nonshared","undefined"!=typeof t[yx].sfname)var xx=t[yx].sfname;var ex=t[yx].usernamedec,nx=t[yx].passworddec;nx||(nx="");var tx=t[yx].passworddecfix,ax=t[yx].domain2lvl,sx="undefined"!=typeof t[yx].realdomain2lvl?t[yx].realdomain2lvl:ax,dx="undefined"!=typeof t[yx].vulnerable;"undefined"==typeof s&&(s=0),"undefined"==typeof z&&(z=0),"undefined"==typeof S[xx]&&(S[xx]=0),"undefined"==typeof v[xx]&&(v[xx]=0);var rx="function"==typeof get_sitepwlen?get_sitepwlen(sx):1,ox=R&&-1!==Object.values(R).indexOf(t[yx].id);if(dx)"nonshared"==xx&&++z,t[yx].challenge_score=0;else if(nx.length>0&&nx.length<rx)t[yx].challenge_score=0;else{t[yx].challenge_score=challengegetstrength(ex,nx);var ix=k&&-1!==Object.values(k).indexOf(t[yx].realdomain2lvl);C&&(ix||ox)&&(t[yx].is_excluded=!0)}if(""!=tx){if("nonshared"==xx&&(d+=nx.length),"undefined"==typeof E[xx]&&(E[xx]=0),E[xx]+=nx.length,"undefined"==typeof w[xx]&&(w[xx]=[]),"nonshared"==xx&&!ox){"undefined"==typeof r[tx]&&(r[tx]=[]),("undefined"==typeof r[tx][ax]||"function"==typeof r[tx][ax]&&"undefined"==typeof r[tx][ax].push)&&(r[tx][ax]=[]);try{r[tx][ax].push(yx)}catch(vx){return ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",void(tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if("undefined"==typeof U&&(U=[]),!ox){"undefined"==typeof U[tx]&&(U[tx]=[],M[tx]=[]),("undefined"==typeof U[tx][ax]||"function"==typeof U[tx][ax]&&"undefined"==typeof U[tx][ax].push)&&(U[tx][ax]=[],M[tx][ax]={users:[],hasDifferentUser:!1});try{U[tx][ax].push(yx),M[tx][ax].hasDifferentUser||M[tx][ax].users.forEach((function(x){x===ex||(M[tx][ax].hasDifferentUser=!0)})),M[tx][ax].users.push(ex)}catch(vx){return ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",void(tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if("nonshared"!=xx){"undefined"==typeof w[xx][tx]&&(w[xx][tx]=[]),("undefined"==typeof w[xx][tx][ax]||"function"==typeof w[xx][tx][ax]&&"undefined"==typeof w[xx][tx][ax].push)&&(w[xx][tx][ax]=[]);try{w[xx][tx][ax].push(yx)}catch(vx){return ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",void(tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if(++$>o){var cx=null;try{"function"==typeof setTimeout?cx=setTimeout:"undefined"!=typeof LP&&"undefined"!=typeof LP.mostRecent&&"undefined"!=typeof LP.mostRecent().setTimeout&&(cx=LP.mostRecent().setTimeout)}catch(vx){}return cx((function(){challengecomputescore_async(yx+1,e,n,t,a,s,d,r,o,i,c,u,f,l,p,g,h,y,m,_,v,S,b,E,w,j,O,T,D,P,z,U,N,A,L,M,C,R,k,F,W,I,V,H,X,K)}),0),ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",void(tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}else"nonshared"==xx&&s++,S[xx]++,"undefined"!==typeof A&&A.push(yx),ex="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",nx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",tx="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}for(Y in g_challengeregexcache=[],d=a==s?0:Math.round(10*d/(a-s))/10,r)if(Q=0,r.hasOwnProperty(Y)){Z=r[Y];var ux=!1;for(var fx in Z)M[Y][fx].hasDifferentUser&&(ux=!0),Z.hasOwnProperty(fx)&&Q++;if(1==Q&&!ux||""==Y){if("undefined"!==typeof N)for(var lx in r[Y])for(var px in r[Y][lx])delete N[r[Y][lx][px]];delete r[Y]}else{for(var fx in++i,q=0,Z)Z.hasOwnProperty(fx)&&(q+=r[Y][fx].length);for(var fx in c+=q,Z)if(Z.hasOwnProperty(fx))for(G in J=r[Y][fx])J.hasOwnProperty(G)&&(yx=r[Y][fx][G],t[yx].challenge_numduplicates=q,t[yx].challenge_duplicatescore=t[yx].challenge_score/Q)}}Y="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",function(){var x,e,n;for(n in n="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","undefined"==typeof U&&(U={}),U)if(U.hasOwnProperty(n)){x=U[n],e=0;var t=!1;for(var a in x)M[n][a].hasDifferentUser&&(t=!0),x.hasOwnProperty(a)&&++e;(1==e&&!t||""==n)&&delete U[n]}}(),Y="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";var gx,hx=0;for(yx=0;yx<t.length;++yx)"undefined"!=typeof t[yx].sfname&&(xx=t[yx].sfname),"undefined"==typeof t[yx].sfname&&(xx="nonshared"),"undefined"==typeof b[xx]&&(b[xx]=0),t[yx].challenge_scorefinal=t[yx].challenge_score,t[yx].usernamedec&&-1!==t[yx].usernamedec.indexOf("@")&&!(t[yx].usernamedec in u)&&(u[t[yx].usernamedec]=[],u[t[yx].usernamedec].hash=lp_sha2lib.sha256(t[yx].usernamedec),u[t[yx].usernamedec].link=t[yx].link),"undefined"==typeof t[yx].challenge_dictionary||"undefined"==typeof t[yx].challenge_duplicatescore?"undefined"==typeof t[yx].challenge_dictionary?"undefined"==typeof t[yx].challenge_duplicatescore?(t[yx].challenge_score<f&&""!=t[yx].passworddecfix&&("nonshared"==xx&&++g,"nonshared"!=xx&&++b[xx]),"nonshared"==xx&&(t[yx].is_excluded&&!0===t[yx].is_excluded&&""!==t[yx].passworddec?hx++:l+=F&&_x(t[yx].id)?0:t[yx].challenge_score,K=a==s?0:Math.round(10*l/(a-s-hx))/10,0!=O.length&&(K=O.length==s?0:Math.round(10*l/(O.length-s-hx))/10)),"nonshared"!=xx&&(v[xx]+=t[yx].challenge_score,h[xx]=_[xx]==S[xx]?0:Math.round(10*v[xx]/(y[xx].length-S[xx]))/10),"undefined"==typeof j[xx]&&(j[xx]=0),t[yx].challenge_score>=70&&"undefined"==typeof t[yx].sfname&&(p+=2),t[yx].challenge_score>=70&&"undefined"!=typeof t[yx].sfname&&(j[xx]+=2)):(t[yx].challenge_scorefinal=t[yx].challenge_duplicatescore,"undefined"==typeof t[yx].sfname&&(l+=F&&_x(t[yx].id)?0:t[yx].challenge_duplicatescore),"undefined"!=typeof t[yx].sfname&&(v[xx]+=t[yx].challenge_duplicatescore)):(t[yx].challenge_scorefinal=.5*t[yx].challenge_scorefinal,"nonshared"==xx&&++g,"nonshared"!=xx&&++b[xx]):(t[yx].challenge_scorefinal=.5*t[yx].challenge_duplicatescore,"nonshared"==xx&&++g,"nonshared"!=xx&&++b[xx]);if(p>100&&(p=100),j[xx]>100&&(j[xx]=100),"undefined"!=typeof O&&0!=O.length&&(a=O.length),a-s>0)if(F){gx=70;(e=Math.round(l/(a-s-hx)*7)/10)>gx&&(e=gx)}else gx=100,(e=Math.round(10*(l/(a-s-hx)*.8+p/10))/10)>gx&&(e=gx);for(var yx=0;yx<D.length;yx++)xx=D[yx],"undefined"==typeof y[xx]&&(y[xx]=[]),"undefined"==typeof S[xx]&&(S[xx]=0),y[xx].length-S[xx]>0&&(P[xx]=Math.round(10*(v[xx]/(y[xx].length-S[xx])*.8+j[xx]/10))/10);m=(new Date).getTime()-m;var mx=Math.round(m/1e3);B()}else B();function _x(x){var e=JSON.parse(n),t=e[x]&&"1"===e[x].last_credential_monitoring_state,a=e[x]&&Number(e[x].last_credential_monitoring_state)>1,s=W.filter((function(n){return lp_sha2lib.sha256(e[x].unencryptedUsername)===n.usernameHash&&e[x].url.indexOf(n.url)>-1}));return t||s.length&&!a}}onmessage=function(x){if("zxcvbn"===x.data.source&&"challengecomputescore_async"===x.data.cmd&&handleSecurityScoreCalculation(x),x.data.cmd===WORKER_MESSAGE_COMPUTE_PW_SCORE){"undefined"===typeof x.data.useLevenshteinDistance&&useLevenshteinDistance!==LEVENSHTEIN_DEFAULT?setupZXCVBN(LEVENSHTEIN_DEFAULT):"undefined"!==typeof x.data.useLevenshteinDistance&&x.data.useLevenshteinDistance!==useLevenshteinDistance&&setupZXCVBN(x.data.useLevenshteinDistance);var e=challengegetstrength(x.data.username,x.data.password);postMessage({cmd:WORKER_MESSAGE_COMPUTE_PW_SCORE_RESULT,result:e,password:lp_sha2lib.sha256(x.data.password)})}},setupZXCVBN(LEVENSHTEIN_DEFAULT)}